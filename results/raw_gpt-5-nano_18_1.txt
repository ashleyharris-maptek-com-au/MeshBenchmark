// OpenSCAD plan: Tallest pyramid built from 50 cm (500 mm) cubes
// Budget: 150,000 stones; actual construction uses the maximum possible under the rule
// Each stone: 50 cm side (500 mm), volume 125,000,000 mm^3
// Stacking rule: each upper stone rests on four stones below (centers of lower stones)
// Resulting pyramid: layers of (m-k) x (m-k) stones for k = 0..m-1, with m = 76 (base 76x76)

// Metrics (mm units)
stone = 500;            // side length of stone (mm)
base_dim = 76;          // number of stones along one edge on the bottom layer
layers = base_dim;       // total layers

// Derived counts
total_stones = base_dim*(base_dim + 1)*(2*base_dim + 1)/6; // 1^2 + 2^2 + ... + 76^2
volume_per_stone = stone*stone*stone;                    // mm^3
total_volume_mm3 = total_stones * volume_per_stone;       // mm^3
height_mm = base_dim * stone;                             // overall pyramid height (mm)
leftover_stones = 150000 - total_stones;                   // budget check

// Simple helper module to place a single stone
module stoneCube(x, y, z) {
    translate([x, y, z])
        cube([stone, stone, stone], center = false);
}

// Build the pyramid: for each layer k = 0 (bottom) to layers-1 (top),
// place an (base_dim - k) x (base_dim - k) grid of stones.
// Each stone's bottom-left corner is at (i*stone + stone/2, j*stone + stone/2, k*stone)
for (k = [0 : layers - 1]) {
    mk = base_dim - k;
    for (i = [0 : mk - 1]) {
        for (j = [0 : mk - 1]) {
            x = i*stone + stone/2;
            y = j*stone + stone/2;
            z = k*stone;
            stoneCube(x, y, z);
        }
    }
}

// Optional: display budget info in console during compile
// echo("Total stones used: ", total_stones);
// echo("Budget stones available: 150000");
// echo("Leftover stones (unused): ", leftover_stones);
// echo("Total pyramid height: ", height_mm, " mm");